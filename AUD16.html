<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>EduNest - Exercise 4 (16. MP3)</title>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;500;600;700&family=Poppins:wght@400;600;700&display=swap" rel="stylesheet">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; }
        :root {
            --primary-red:#FF3B3B; --dark-red:#D62828; --light-red:#FF6B6B;
            --bg-gradient:linear-gradient(135deg,#667eea 0%,#764ba2 100%);
            --card-bg:#ffffff; --text-dark:#2d3748; --text-light:#718096;
            --success:#48bb78; --success-dark:#38a169;
            --wrong:#ef4444; --wrong-bg:#fef2f2; --wrong-border:#fca5a5;
            --correct-bg:#f0fff4; --correct-border:#86efac;
        }
        body { font-family:'Poppins',sans-serif; background:var(--bg-gradient); min-height:100vh; display:flex; align-items:center; justify-content:center; padding:20px; overflow-x:hidden; }
        body::before { content:''; position:fixed; top:0; left:0; width:100%; height:100%; background:radial-gradient(circle at 20% 50%,rgba(255,59,59,0.1) 0%,transparent 50%),radial-gradient(circle at 80% 80%,rgba(102,126,234,0.15) 0%,transparent 50%); pointer-events:none; z-index:0; }
        .container { position:relative; z-index:1; max-width:600px; width:100%; }

        /* WELCOME */
        .welcome-screen { background:var(--card-bg); border-radius:30px; padding:60px 40px; text-align:center; box-shadow:0 20px 60px rgba(0,0,0,0.2); border:4px solid var(--primary-red); animation:slideUp 0.6s ease-out; }
        @keyframes slideUp { from{opacity:0;transform:translateY(30px)} to{opacity:1;transform:translateY(0)} }
        .logo { font-family:'Fredoka',sans-serif; font-size:3.5rem; font-weight:700; color:var(--primary-red); margin-bottom:10px; text-transform:uppercase; letter-spacing:2px; text-shadow:3px 3px 0 rgba(255,59,59,0.2); }
        .tagline { font-size:1.1rem; color:var(--text-light); margin-bottom:40px; font-weight:500; }
        .welcome-title { font-size:2rem; color:var(--text-dark); margin-bottom:15px; font-weight:700; }
        .welcome-subtitle { font-size:1.1rem; color:var(--text-light); margin-bottom:40px; }
        .name-input-wrapper { position:relative; margin-bottom:30px; }
        .name-input { width:100%; padding:20px 25px; font-size:1.2rem; border:3px solid var(--primary-red); border-radius:15px; outline:none; font-family:'Poppins',sans-serif; transition:all 0.3s ease; }
        .name-input:focus { border-color:var(--dark-red); box-shadow:0 0 0 4px rgba(255,59,59,0.1); transform:translateY(-2px); }
        .start-btn { background:var(--primary-red); color:white; border:none; padding:20px 60px; font-size:1.3rem; font-weight:700; border-radius:15px; cursor:pointer; transition:all 0.3s ease; font-family:'Fredoka',sans-serif; text-transform:uppercase; letter-spacing:1px; box-shadow:0 8px 20px rgba(255,59,59,0.3); }
        .start-btn:hover { background:var(--dark-red); transform:translateY(-3px); box-shadow:0 12px 30px rgba(255,59,59,0.4); }
        .start-btn:active { transform:translateY(-1px); }
        .start-btn:disabled { opacity:0.5; cursor:not-allowed; transform:none; }

        /* EXERCISE */
        .exercise-screen { display:none; background:var(--card-bg); border-radius:30px; padding:40px; box-shadow:0 20px 60px rgba(0,0,0,0.2); border:4px solid var(--primary-red); animation:slideUp 0.6s ease-out; }
        .exercise-header { text-align:center; margin-bottom:30px; padding-bottom:25px; border-bottom:3px solid var(--primary-red); }
        .exercise-logo { font-family:'Fredoka',sans-serif; font-size:2.5rem; font-weight:700; color:var(--primary-red); margin-bottom:10px; text-transform:uppercase; }
        .student-greeting { font-size:1.3rem; color:var(--text-dark); font-weight:600; }
        .exercise-title { font-size:1.6rem; color:var(--text-dark); margin-bottom:25px; font-weight:700; text-align:center; }
        .instructions { background:linear-gradient(135deg,#fff5f5 0%,#ffe5e5 100%); border-left:5px solid var(--primary-red); padding:20px 25px; border-radius:15px; margin-bottom:30px; }
        .instructions p { color:var(--text-dark); font-size:1rem; line-height:1.6; margin-bottom:8px; }
        .instructions p:last-child { margin-bottom:0; }

        /* PROGRESS */
        .progress-bar { display:flex; align-items:center; justify-content:center; gap:12px; margin-bottom:20px; padding:12px 20px; background:white; border-radius:15px; border:2px solid #e2e8f0; }
        .progress-text { font-family:'Fredoka',sans-serif; font-size:1rem; font-weight:600; color:var(--text-dark); }
        .progress-track { flex:1; max-width:250px; height:10px; background:#e2e8f0; border-radius:5px; overflow:hidden; }
        .progress-fill { height:100%; background:linear-gradient(90deg,var(--primary-red),var(--success)); border-radius:5px; transition:width 0.4s ease; width:0%; }
        .progress-count { font-family:'Fredoka',sans-serif; font-size:0.95rem; font-weight:600; color:var(--text-light); min-width:55px; text-align:right; }

        /* NUMBER LIST */
        .number-list { display:flex; flex-direction:column; gap:8px; margin-bottom:30px; }

        .number-row {
            display:flex; align-items:center; gap:14px;
            padding:14px 20px; background:white;
            border:3px solid #e2e8f0; border-radius:16px;
            transition:all 0.35s ease;
        }
        .number-row.active-row { border-color:var(--primary-red); box-shadow:0 0 0 4px rgba(255,59,59,0.12), 0 4px 15px rgba(255,59,59,0.1); transform:scale(1.02); }
        .number-row.marked-correct { border-color:var(--success); background:var(--correct-bg); }
        .number-row.marked-wrong { border-color:var(--wrong); background:var(--wrong-bg); }
        .number-row.done-row { opacity:0.7; }
        .number-row.done-row.marked-correct, .number-row.done-row.marked-wrong { opacity:1; }

        .row-index { font-family:'Fredoka',sans-serif; font-size:0.8rem; font-weight:700; color:white; background:var(--primary-red); width:28px; height:28px; line-height:28px; border-radius:50%; text-align:center; flex-shrink:0; }

        .given-number { font-family:'Fredoka',sans-serif; font-size:1.8rem; font-weight:700; color:var(--text-dark); min-width:55px; text-align:center; flex-shrink:0; }
        .number-row.marked-correct .given-number { color:var(--success-dark); }
        .number-row.marked-wrong .given-number { color:var(--wrong); text-decoration:line-through; }

        .row-separator { flex:1; height:2px; background:#e2e8f0; border-radius:1px; }

        /* Tick / Cross buttons */
        .choice-buttons { display:flex; gap:10px; flex-shrink:0; }

        .choice-btn {
            width:56px; height:56px; border-radius:50%;
            border:3px solid #e2e8f0; background:white;
            cursor:pointer; display:flex; align-items:center; justify-content:center;
            transition:all 0.25s ease; font-size:1.6rem;
            -webkit-tap-highlight-color:transparent; user-select:none;
        }

        .choice-btn.btn-tick { color:#a7f3d0; }
        .choice-btn.btn-tick:hover { border-color:var(--success); background:#f0fff4; color:var(--success); transform:scale(1.1); }
        .choice-btn.btn-cross { color:#fecaca; }
        .choice-btn.btn-cross:hover { border-color:var(--wrong); background:#fef2f2; color:var(--wrong); transform:scale(1.1); }

        .choice-btn:active { transform:scale(0.92); }

        .choice-btn.btn-tick.selected { border-color:var(--success); background:var(--success); color:white; box-shadow:0 3px 12px rgba(72,187,120,0.5); }
        .choice-btn.btn-cross.selected { border-color:var(--wrong); background:var(--wrong); color:white; box-shadow:0 3px 12px rgba(239,68,68,0.5); }

        @keyframes btnPop { 0%{transform:scale(1)} 40%{transform:scale(1.3)} 100%{transform:scale(1)} }
        .choice-btn.pop { animation:btnPop 0.3s ease; }

        @keyframes rowSlideIn { 0%{background-color:white} 100%{} }

        .row-status-text { font-size:0.75rem; font-weight:700; text-transform:uppercase; letter-spacing:0.5px; min-width:50px; text-align:center; flex-shrink:0; }
        .number-row.marked-correct .row-status-text { color:var(--success-dark); }
        .number-row.marked-wrong .row-status-text { color:var(--wrong); }

        /* BUTTONS */
        .button-group { display:flex; gap:15px; justify-content:center; flex-wrap:wrap; }
        .btn { padding:15px 35px; font-size:1.1rem; font-weight:600; border:none; border-radius:12px; cursor:pointer; transition:all 0.3s ease; font-family:'Poppins',sans-serif; text-transform:uppercase; letter-spacing:0.5px; }
        .btn-submit { background:var(--success); color:white; box-shadow:0 6px 15px rgba(72,187,120,0.3); }
        .btn-submit:hover { background:#38a169; transform:translateY(-2px); box-shadow:0 8px 20px rgba(72,187,120,0.4); }
        .btn-copy { background:#3182ce; color:white; box-shadow:0 6px 15px rgba(49,130,206,0.3); }
        .btn-copy:hover { background:#2c5282; transform:translateY(-2px); box-shadow:0 8px 20px rgba(49,130,206,0.4); }

        /* ANSWER SHEET */
        .answer-sheet { display:none; background:white; border:3px solid var(--primary-red); border-radius:15px; padding:30px; margin-top:30px; }
        .answer-sheet.visible { display:block; }
        .answer-sheet-title { font-size:1.5rem; color:var(--text-dark); font-weight:700; margin-bottom:20px; text-align:center; }
        .answer-list { display:flex; flex-direction:column; gap:5px; margin-bottom:20px; }
        .answer-row { display:flex; align-items:center; gap:10px; padding:10px 15px; border-radius:10px; font-size:0.95rem; font-weight:600; }
        .answer-row.is-correct { background:#f0fff4; color:var(--success-dark); }
        .answer-row.is-wrong { background:#fef2f2; color:var(--wrong); }
        .answer-row.is-empty { background:#f7fafc; color:var(--text-light); }
        .answer-row .a-index { font-family:'Fredoka',sans-serif; font-size:0.8rem; background:var(--primary-red); color:white; width:24px;height:24px;line-height:24px;border-radius:50%;text-align:center; flex-shrink:0; }
        .answer-row .a-result { font-weight:700; }

        .summary-box { display:flex; justify-content:center; gap:30px; margin-bottom:20px; padding:15px; background:#f7fafc; border-radius:12px; border:2px solid #e2e8f0; }
        .summary-item { text-align:center; }
        .summary-num { font-family:'Fredoka',sans-serif; font-size:2rem; font-weight:700; }
        .summary-num.green { color:var(--success); }
        .summary-num.red { color:var(--wrong); }
        .summary-num.gray { color:var(--text-light); }
        .summary-label { font-size:0.75rem; font-weight:600; color:var(--text-light); text-transform:uppercase; }

        .copy-section { text-align:center; padding-top:20px; border-top:2px solid #e2e8f0; }
        .copy-message { margin-top:10px; color:var(--success); font-weight:600; display:none; }
        .hidden { display:none !important; }

        @media (max-width:600px) {
            .logo { font-size:2.5rem; }
            .welcome-screen { padding:40px 20px; }
            .welcome-title { font-size:1.5rem; }
            .exercise-screen { padding:25px 15px; }
            .exercise-logo { font-size:2rem; }
            .exercise-title { font-size:1.2rem; }
            .number-row { padding:12px 14px; gap:10px; }
            .given-number { font-size:1.5rem; min-width:45px; }
            .choice-btn { width:48px; height:48px; font-size:1.4rem; }
            .btn { padding:12px 25px; font-size:1rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- WELCOME -->
        <div class="welcome-screen" id="welcomeScreen">
            <div class="logo">ðŸŽ“ EduNest</div>
            <div class="tagline">Your Learning Adventure Begins Here</div>
            <h1 class="welcome-title">Welcome, Student! ðŸ‘‹</h1>
            <p class="welcome-subtitle">Let's start Exercise 4 â€” Find the only wrong number!!!</p>
            <div class="name-input-wrapper">
                <input type="text" class="name-input" id="studentName" placeholder="Enter your name..." autocomplete="off">
            </div>
            <button class="start-btn" id="startBtn" disabled>Start Exercise</button>
        </div>

        <!-- EXERCISE -->
        <div class="exercise-screen" id="exerciseScreen">
            <div class="exercise-header">
                <div class="exercise-logo">ðŸŽ“ EduNest</div>
                <div class="student-greeting" id="studentGreeting"></div>
            </div>

            <h2 class="exercise-title">Exercise 4. ( 16. MP3 ) Find the only wrong number!!!</h2>

            <div class="instructions">
                <p><strong>ðŸ”¢ Instructions:</strong></p>
                <p>â€¢ Listen to each group of numbers in the recording</p>
                <p>â€¢ For each number: press <strong>âœ“</strong> if it's correct or <strong>âœ—</strong> if it's wrong</p>
                <p>â€¢ The cursor auto-advances to the next number after you choose</p>
                <p>â€¢ You can tap any row to go back and change your answer</p>
            </div>

            <div class="progress-bar">
                <span class="progress-text">Progress</span>
                <div class="progress-track"><div class="progress-fill" id="progressFill"></div></div>
                <span class="progress-count" id="progressCount">0 / 21</span>
            </div>

            <div class="number-list" id="numberList"></div>

            <div class="button-group">
                <button class="btn btn-submit" id="submitBtn">âœ“ Submit Answers</button>
            </div>

            <div class="answer-sheet" id="answerSheet">
                <h3 class="answer-sheet-title" id="answerSheetTitle">ðŸ“‹ Student Name</h3>
                <div class="summary-box" id="summaryBox"></div>
                <div id="answerContent"></div>
                <div class="copy-section">
                    <button class="btn btn-copy" id="copyBtn">ðŸ“‹ Copy Answers</button>
                    <p class="copy-message" id="copyMessage">âœ“ Answers copied to clipboard!</p>
                </div>
            </div>
        </div>
    </div>

    <script>
    /*
    â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
    â•‘  âœï¸  EXERCISE DATA â€” just list the numbers from the textbook   â•‘
    â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
    */
    const givenNumbers = [
         6, 96, 49, 11, 13, 78,
        19, 18, 57, 83, 24, 75,
        64, 51, 25, 33, 22, 91
    ];

    /* ================================================================ */

    const welcomeScreen    = document.getElementById('welcomeScreen');
    const exerciseScreen   = document.getElementById('exerciseScreen');
    const studentNameInput = document.getElementById('studentName');
    const startBtn         = document.getElementById('startBtn');
    const studentGreeting  = document.getElementById('studentGreeting');
    const numberList       = document.getElementById('numberList');
    const progressFill     = document.getElementById('progressFill');
    const progressCount    = document.getElementById('progressCount');
    const submitBtn        = document.getElementById('submitBtn');
    const answerSheet      = document.getElementById('answerSheet');
    const answerSheetTitle = document.getElementById('answerSheetTitle');
    const summaryBox       = document.getElementById('summaryBox');
    const answerContent    = document.getElementById('answerContent');
    const copyBtn          = document.getElementById('copyBtn');
    const copyMessage      = document.getElementById('copyMessage');

    let studentName = '';
    // 'correct', 'wrong', or null
    let rowStates = [];
    let activeIdx = 0;

    studentNameInput.addEventListener('input', (e) => { startBtn.disabled = e.target.value.trim().length === 0; });
    studentNameInput.addEventListener('keypress', (e) => { if (e.key === 'Enter' && !startBtn.disabled) startBtn.click(); });

    startBtn.addEventListener('click', () => {
        studentName = studentNameInput.value.trim();
        if (studentName) {
            welcomeScreen.classList.add('hidden');
            exerciseScreen.style.display = 'block';
            studentGreeting.textContent = `Hello, ${studentName}! ðŸŒŸ`;
            generateRows();
            if (document.documentElement.requestFullscreen) document.documentElement.requestFullscreen().catch(() => {});
        }
    });

    function generateRows() {
        numberList.innerHTML = '';
        rowStates = givenNumbers.map(() => null);
        activeIdx = 0;

        givenNumbers.forEach((num, idx) => {
            const row = document.createElement('div');
            row.className = 'number-row';
            row.id = `row_${idx}`;

            row.innerHTML = `
                <div class="row-index">${idx + 1}</div>
                <div class="given-number">${num}</div>
                <div class="row-separator"></div>
                <div class="choice-buttons">
                    <button class="choice-btn btn-tick" data-idx="${idx}" data-choice="correct" aria-label="Correct">âœ“</button>
                    <button class="choice-btn btn-cross" data-idx="${idx}" data-choice="wrong" aria-label="Wrong">âœ—</button>
                </div>
                <div class="row-status-text" id="status_${idx}"></div>
            `;

            numberList.appendChild(row);

            // Click on row to make it active
            row.addEventListener('click', (e) => {
                if (e.target.closest('.choice-btn')) return;
                setActiveRow(idx);
            });

            // Tick button
            row.querySelector('.btn-tick').addEventListener('click', () => handleChoice(idx, 'correct'));
            // Cross button
            row.querySelector('.btn-cross').addEventListener('click', () => handleChoice(idx, 'wrong'));
        });

        setActiveRow(0);
        updateProgress();
    }

    function handleChoice(idx, choice) {
        const row = document.getElementById(`row_${idx}`);
        const tickBtn = row.querySelector('.btn-tick');
        const crossBtn = row.querySelector('.btn-cross');
        const status = document.getElementById(`status_${idx}`);

        // Toggle if same choice clicked again
        if (rowStates[idx] === choice) {
            rowStates[idx] = null;
            tickBtn.classList.remove('selected');
            crossBtn.classList.remove('selected');
            row.classList.remove('marked-correct', 'marked-wrong');
            status.textContent = '';
            updateProgress();
            return;
        }

        rowStates[idx] = choice;

        // Update buttons
        tickBtn.classList.remove('selected');
        crossBtn.classList.remove('selected');
        row.classList.remove('marked-correct', 'marked-wrong');

        if (choice === 'correct') {
            tickBtn.classList.add('selected', 'pop');
            setTimeout(() => tickBtn.classList.remove('pop'), 300);
            row.classList.add('marked-correct');
            status.textContent = 'âœ“';
        } else {
            crossBtn.classList.add('selected', 'pop');
            setTimeout(() => crossBtn.classList.remove('pop'), 300);
            row.classList.add('marked-wrong');
            status.textContent = 'âœ—';
        }

        updateProgress();

        // Auto-advance to next unanswered
        setTimeout(() => {
            const nextIdx = findNextUnanswered(idx);
            if (nextIdx !== -1) {
                setActiveRow(nextIdx);
                // Scroll into view
                document.getElementById(`row_${nextIdx}`).scrollIntoView({ behavior: 'smooth', block: 'center' });
            } else {
                // All done â€” remove active highlight
                clearActiveRow();
            }
        }, 250);
    }

    function findNextUnanswered(fromIdx) {
        // First check after current
        for (let i = fromIdx + 1; i < givenNumbers.length; i++) {
            if (rowStates[i] === null) return i;
        }
        // Then check before current
        for (let i = 0; i < fromIdx; i++) {
            if (rowStates[i] === null) return i;
        }
        return -1;
    }

    function setActiveRow(idx) {
        activeIdx = idx;
        document.querySelectorAll('.number-row').forEach((r, i) => {
            r.classList.toggle('active-row', i === idx);
        });
    }

    function clearActiveRow() {
        document.querySelectorAll('.number-row').forEach(r => r.classList.remove('active-row'));
    }

    function updateProgress() {
        const done = rowStates.filter(s => s !== null).length;
        const total = givenNumbers.length;
        progressFill.style.width = ((done / total) * 100) + '%';
        progressCount.textContent = `${done} / ${total}`;
    }

    // Submit
    submitBtn.addEventListener('click', () => {
        answerSheetTitle.textContent = `ðŸ“‹ ${studentName}`;

        const correctCount = rowStates.filter(s => s === 'correct').length;
        const wrongCount = rowStates.filter(s => s === 'wrong').length;
        const emptyCount = rowStates.filter(s => s === null).length;

        summaryBox.innerHTML = `
            <div class="summary-item"><div class="summary-num green">${correctCount}</div><div class="summary-label">Correct</div></div>
            <div class="summary-item"><div class="summary-num red">${wrongCount}</div><div class="summary-label">Wrong</div></div>
            <div class="summary-item"><div class="summary-num gray">${emptyCount}</div><div class="summary-label">Skipped</div></div>
        `;

        let html = '<div class="answer-list">';
        givenNumbers.forEach((num, idx) => {
            const state = rowStates[idx];
            let cls, text;
            if (state === 'correct') { cls = 'is-correct'; text = `${num}  âœ“ Correct`; }
            else if (state === 'wrong') { cls = 'is-wrong'; text = `${num}  âœ— Wrong`; }
            else { cls = 'is-empty'; text = `${num}  â€” Skipped`; }

            html += `<div class="answer-row ${cls}"><span class="a-index">${idx+1}</span><span class="a-result">${text}</span></div>`;
        });
        html += '</div>';

        answerContent.innerHTML = html;
        answerSheet.classList.add('visible');
        answerSheet.scrollIntoView({ behavior:'smooth', block:'nearest' });
    });

    // Copy
    copyBtn.addEventListener('click', () => {
        let text = `${studentName}\nExercise 4. (16. MP3) â€” Find the wrong number\n\n`;
        givenNumbers.forEach((num, idx) => {
            const state = rowStates[idx];
            if (state === 'correct') text += `${idx+1}. ${num}  âœ“ Correct\n`;
            else if (state === 'wrong') text += `${idx+1}. ${num}  âœ— WRONG\n`;
            else text += `${idx+1}. ${num}  â€” Skipped\n`;
        });

        const wrongNums = givenNumbers.filter((n,i) => rowStates[i] === 'wrong');
        if (wrongNums.length > 0) text += `\nWrong numbers: ${wrongNums.join(', ')}`;

        if (navigator.clipboard && navigator.clipboard.writeText) {
            navigator.clipboard.writeText(text).then(showCopySuccess).catch(() => fallbackCopy(text));
        } else { fallbackCopy(text); }
    });

    function fallbackCopy(text) {
        const ta = document.createElement('textarea'); ta.value = text;
        Object.assign(ta.style, {position:'fixed',top:'0',left:'0',width:'2em',height:'2em',padding:'0',border:'none',outline:'none',boxShadow:'none',background:'transparent',opacity:'0'});
        document.body.appendChild(ta); ta.focus(); ta.select(); ta.setSelectionRange(0,99999);
        try { document.execCommand('copy') ? showCopySuccess() : alert('Failed to copy.'); } catch { alert('Failed to copy.'); }
        document.body.removeChild(ta);
    }

    function showCopySuccess() { copyMessage.style.display='block'; setTimeout(()=>{copyMessage.style.display='none';},3000); }
    </script>
</body>
</html>